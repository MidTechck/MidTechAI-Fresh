<!DOCTYPE html>
<html>
<head>
    <title>MidTechAI Assistant</title>
    <style>
        body{
            margin:0;
            font-family: 'Segoe UI', sans-serif;
            background:#0a0a0f;
            color:white;
            display:flex;
            flex-direction:column;
            height:100vh;
            transition: background 0.5s, color 0.5s;
        }

        header{
            padding:15px;
            text-align:center;
            font-size:28px;
            background: linear-gradient(90deg,#0ff,#8a2be2);
            display:flex;
            justify-content:space-between;
            align-items:center;
        }

        #themeToggle{
            padding:5px 10px; 
            border:none; 
            border-radius:5px; 
            cursor:pointer;
            background:#0ff; 
            color:#000;
            font-weight:bold;
        }

        #chat{
            flex:1;
            padding:20px;
            overflow-y:auto;
        }

        .msg{
            margin:10px 0;
            padding:12px 18px;
            border-radius:16px;
            max-width:70%;
            animation:fadeIn .4s ease;
            word-wrap: break-word;
        }

        .user{
            background:#1f1f1f;
            margin-left:auto;
            border:1px solid #0ff;
        }

        .ai{
            background:linear-gradient(90deg,#0ff,#8a2be2);
            color:#000;
        }

        @keyframes fadeIn{
            from{opacity:0; transform:scale(.9);}
            to{opacity:1; transform:scale(1);}
        }

        #typing{
            display:flex;
            margin:10px;
        }

        .dot{
            height:10px;
            width:10px;
            margin:0 4px;
            border-radius:50%;
            display:inline-block;
            animation:bounce 1.2s infinite, glow 1.2s infinite;
            background:#0ff;
        }

        .dot:nth-child(2){animation-delay:.2s;}
        .dot:nth-child(3){animation-delay:.4s;}

        @keyframes bounce{
            0%,100%{transform:translateY(0);}
            50%{transform:translateY(-8px);}
        }

        @keyframes glow{
            0%,100%{box-shadow:0 0 2px #0ff;}
            50%{box-shadow:0 0 10px #0ff;}
        }

        /* Light mode overrides */
        body.light{
            background:#f4f4f4;
            color:#111;
        }

        body.light input{
            background:#e0e0e0;
            color:#111;
        }

        body.light .user{
            background:#d3d3d3;
            color:#111;
            border:1px solid #0ff;
        }

        body.light .ai{
            background:linear-gradient(90deg,#0ff,#8a2be2);
            color:#000;
        }

        body.light #inputArea{
            background:#e5e5e5;
        }

        body.light .dot{
            background:#0077cc;
            animation-name: bounce, glowLight;
        }

        @keyframes glowLight{
            0%,100%{box-shadow:0 0 2px #0077cc;}
            50%{box-shadow:0 0 8px #0077cc;}
        }

        #inputArea{
            display:flex;
            padding:15px;
            background:#1a1a1a;
        }

        input{
            flex:1;
            padding:12px;
            border-radius:10px;
            border:none;
            background:#2b2b2b;
            color:white;
            outline:none;
        }

        button{
            margin-left:10px;
            padding:12px 18px;
            border:none;
            border-radius:10px;
            background:#0ff;
            cursor:pointer;
        }

    </style>
</head>
<body>

<header>
    <span>MidTechAI Assistant</span>
    <button id="themeToggle">Toggle Theme</button>
</header>

<div id="chat"></div>

<div id="typing" style="display:none;">
    <span class="dot"></span>
    <span class="dot"></span>
    <span class="dot"></span>
</div>

<div id="inputArea">
    <input id="msg" placeholder="Ask me anything..."/>
    <button onclick="send()">Send</button>
</div>

<script>
function addMessage(text,cls){
    let div=document.createElement("div");
    div.className="msg "+cls;
    div.innerText=text;
    document.getElementById("chat").appendChild(div);
    div.scrollIntoView({behavior:"smooth"});
}

function sleep(ms){return new Promise(resolve=>setTimeout(resolve,ms));}

async function send(){
    const input=document.getElementById("msg");
    const msg=input.value.trim();
    if(!msg) return;
    addMessage(msg,"user");
    input.value="";

    const typingDiv=document.getElementById("typing");
    typingDiv.style.display="flex";

    await sleep(1200); // 1.2s typing animation

    typingDiv.style.display="none";

    try{
        const res=await fetch("/chat",{
            method:"POST",
            headers:{"Content-Type":"application/json"},
            body:JSON.stringify({message:msg})
        });
        const data=await res.json();
        addMessage(data.reply,"ai");
    }catch(err){
        addMessage("Error: Unable to fetch response.","ai");
    }
}

// Dark/Light Mode toggle
const themeToggle = document.getElementById("themeToggle");
themeToggle.addEventListener("click", () => {
    document.body.classList.toggle("light");
});
</script>

</body>
</html>
